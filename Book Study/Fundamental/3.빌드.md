## 빌드의 구성
* 빌드는 `전처리` -> `컴파일` -> `링크`의 과정으로 진행됩니다.
* 이 과정을 통해서 바이너리(실행 파일, 동적 라이브러리, 정적 라이브러리)를 생성합니다.

### 컴파일 
* 컴파일 대상이 되는 파일은 소스파일(cpp 파일) 입니다. 
  * 헤더 파일은 컴파일 대상이 아닙니다.
  * 헤더 파일은 오직 #include에 의해서 cpp파일에 포함된 헤더 파일이 같이 컴파일 되는 것 뿐입니다.
* 소스 파일이 컴파일 되면 목적(Object) 파일이 생성됩니다. 
  * 목적 파일과 소스파일을 일대일 대응이 됩니다. 
  * 사람이 읽을 수 있는 소스파일을 기계어로 구성된 목적 파일로 변환 한 것입니다. 

### 링크
* 보통의 바이너리는 많은 수의 목적 파일에 의해서 구성됩니다. 
* 이러한 목적 파일을 적절히 연결하는 과정을 링크라고 합니다. 
  * 예를 들어서 main.cpp에서 사용하는 printf의 코드 부분을 printf.obj 파일이 프로세스 메모리에 올라간 주소로 변경 시켜주는 것이 링크입니다. 
  * 수많은 목적 파일들이 프로세스 메모리 가상 공간에 적재 되었을 때 서로 맞물릴 수 있도록 각각의 주소를 변경해 주는 것을 말합니다. 

### 전처리
* 전처리란 컴파일 이전에 수고스러운 작업들을 효율적인 전처리 지시문을 통해서 기록합니다. 
* 컴파일 시점에 컴파일이 가능하도록 소스 파일에 원래 소스 구문을 복구 하는 작업을 말합니다.
  * `#include` 가장 자주 사용하는 해당 구문도 전처리 지시문입니다.
```c++
// #include를 통해서 stdio.h의 코드를 단축해서 표시 할 수 있습니다.
// 컴파일 시점에 #include <stdio.h>은 stdio.h 코드로 변환됩니다. 
#include <stdio.h>

void main()
{
    printf("Hello World");
}
```

## 전처리 지시문
### `#include`
* 보통은 헤더 파일이 들어가지만 cpp파일도 들어갈 수 있습니다. 
* 따옴표 형식일 경우 동일한 디렉토리를 검색합니다. 
  * 만약 헤더를 찾지 못한다면 /I 컴파일러 옵션에 지정된 경로에 따라서 검색합니다. 
* 꺾쇠 괄호형식일 경우 /I 컴파일러 옵션과 INCLUDE 환경 변수에 지정된 경로를 따라서 검색합니다. 
  * 일반적으로 시스템이나 라이브러리에서 제공하는 헤더 파일을 참조시 사용합니다. 
* 헤더 파일 작성시 주의 사항
  * 전역 변수나 전역 함수를 정의해서는 안됩니다. 선언만 해야 합니다. 

### `#define`
```c++
// identifier가 나타날 때 마다 token-string으로 대체하는 역활을 합니다. 
#define identifier token-string

#define X1 (Y1 + 1)
#define Y1 10

#define X2 (Y2 + 1)
#define Y2 10

void main() 
{
    cout << X1 << endl;
    cout << X2 << endl;
}

// 다음 형식으로도 사용합니다.
// #if defined, #ifdef 를 통해서 분기처리에 사용합니다. 
#define identifier

```
* #undef 를 통해서 매크로를 해제 할 수 있습니다.

### `#pragma once`
* #pragma once는 보통 헤더 파일 맨 처음에 쓰이며 헤더 파일을 단 한번만 포함시키라는 의미 입니다. 

## 미리 정의된 매크로
* __FILE__, __LINE__, __DATE__, __TIME__

## 미리 컴파일된 헤더
* 미리 컴파일된 헤더를 사용하게 되면 미리 만들어진 컴파일된 헤더 파일을 참조하여 컴파일 시간을 줄일 수 있습니다. 
* vc++의 경우에는 `pch`, gcc의 경우에는 `gch`의 파일의 확장자가 만들어 집니다. 
* 즉 거의 변하지 않는 내용을 단 한번만 컴파일해서 재활용 할 수 있습니다. 
* 거의 변경될 일이 없으며 많으 소스 파일들이에 공통적으로 포함될 수 있는 헤더 파일들을 추가하면 좋습니다.
* vc++에서는 `stdafx.h` 파일을 사용해서 등록할 수 있습니다. 

## 링크 에러 
### 확인 할 수 없는 외부 참조
* 링크 단계해서 선언만 하고 정의되지 않은 객체가 존재할 때 발생 

### 여러 번 정의된 기호
* 링크시 중복 정의된 객체가 있다면 발생 
* 보통은 namespace를 사용해서 중복을 제거합니다. 